{"version":3,"file":"_server-CkK1YuoY.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/news-sitemap.xml/_server.js"],"sourcesContent":["import { a as fetchPosts } from \"../../../chunks/wordpress.js\";\nasync function GET() {\n  try {\n    const postsResult = await fetchPosts(1, 100, true);\n    const posts = postsResult.posts || [];\n    const baseUrl = \"https://rasarooz.ir\";\n    const now = /* @__PURE__ */ new Date();\n    let xml = '<?xml version=\"1.0\" encoding=\"UTF-8\"?>';\n    xml += '<urlset xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\" ';\n    xml += 'xmlns:news=\"http://www.google.com/schemas/sitemap-news/0.9\" ';\n    xml += 'xmlns:image=\"http://www.google.com/schemas/sitemap-image/1.1\">';\n    posts.filter((post) => {\n      const pubDate = new Date(post.date);\n      return now - pubDate < 2 * 24 * 60 * 60 * 1e3;\n    }).forEach((post) => {\n      const pubDate = new Date(post.date).toISOString();\n      const title = post.title?.rendered?.replace(/&/g, \"&amp;\")?.replace(/</g, \"&lt;\")?.replace(/>/g, \"&gt;\")?.replace(/\"/g, \"&quot;\")?.replace(/'/g, \"&apos;\") || \"\";\n      xml += `\n  <url>\n    <loc>${baseUrl}/${post.id}/${post.slug}</loc>\n    <news:news>\n      <news:publication>\n        <news:name>رسانه روز</news:name>\n        <news:language>fa</news:language>\n      </news:publication>\n      <news:publication_date>${pubDate}</news:publication_date>\n      <news:title>${title}</news:title>\n    </news:news>`;\n      if (post._embedded?.[\"wp:featuredmedia\"]?.[0]?.source_url) {\n        const imageUrl = post._embedded[\"wp:featuredmedia\"][0].source_url;\n        xml += `\n    <image:image>\n      <image:loc>${imageUrl}</image:loc>\n      <image:title>${title}</image:title>\n    </image:image>`;\n      }\n      xml += `\n  </url>`;\n    });\n    xml += \"\\n</urlset>\";\n    return new Response(xml.trim(), {\n      headers: {\n        \"Content-Type\": \"application/xml\",\n        \"Cache-Control\": \"max-age=0, s-maxage=3600\"\n      }\n    });\n  } catch (error) {\n    if (process.env.NODE_ENV === \"production\") {\n      console.error(`News sitemap generation error: ${error.message}`);\n    }\n    return new Response(\"Error generating sitemap\", { status: 500 });\n  }\n}\nexport {\n  GET\n};\n"],"names":[],"mappings":";;;AACA,eAAe,GAAG,GAAG;AACrB,EAAE,IAAI;AACN,IAAI,MAAM,WAAW,GAAG,MAAM,UAAU,CAAC,CAAC,EAAE,GAAG,EAAE,IAAI,CAAC;AACtD,IAAI,MAAM,KAAK,GAAG,WAAW,CAAC,KAAK,IAAI,EAAE;AACzC,IAAI,MAAM,OAAO,GAAG,qBAAqB;AACzC,IAAI,MAAM,GAAG,mBAAmB,IAAI,IAAI,EAAE;AAC1C,IAAI,IAAI,GAAG,GAAG,wCAAwC;AACtD,IAAI,GAAG,IAAI,8DAA8D;AACzE,IAAI,GAAG,IAAI,8DAA8D;AACzE,IAAI,GAAG,IAAI,gEAAgE;AAC3E,IAAI,KAAK,CAAC,MAAM,CAAC,CAAC,IAAI,KAAK;AAC3B,MAAM,MAAM,OAAO,GAAG,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC;AACzC,MAAM,OAAO,GAAG,GAAG,OAAO,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,GAAG;AACnD,KAAK,CAAC,CAAC,OAAO,CAAC,CAAC,IAAI,KAAK;AACzB,MAAM,MAAM,OAAO,GAAG,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,WAAW,EAAE;AACvD,MAAM,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,EAAE,QAAQ,EAAE,OAAO,CAAC,IAAI,EAAE,OAAO,CAAC,EAAE,OAAO,CAAC,IAAI,EAAE,MAAM,CAAC,EAAE,OAAO,CAAC,IAAI,EAAE,MAAM,CAAC,EAAE,OAAO,CAAC,IAAI,EAAE,QAAQ,CAAC,EAAE,OAAO,CAAC,IAAI,EAAE,QAAQ,CAAC,IAAI,EAAE;AACtK,MAAM,GAAG,IAAI;AACb;AACA,SAAS,EAAE,OAAO,CAAC,CAAC,EAAE,IAAI,CAAC,EAAE,CAAC,CAAC,EAAE,IAAI,CAAC,IAAI,CAAC;AAC3C;AACA;AACA;AACA;AACA;AACA,6BAA6B,EAAE,OAAO,CAAC;AACvC,kBAAkB,EAAE,KAAK,CAAC;AAC1B,gBAAgB,CAAC;AACjB,MAAM,IAAI,IAAI,CAAC,SAAS,GAAG,kBAAkB,CAAC,GAAG,CAAC,CAAC,EAAE,UAAU,EAAE;AACjE,QAAQ,MAAM,QAAQ,GAAG,IAAI,CAAC,SAAS,CAAC,kBAAkB,CAAC,CAAC,CAAC,CAAC,CAAC,UAAU;AACzE,QAAQ,GAAG,IAAI;AACf;AACA,iBAAiB,EAAE,QAAQ,CAAC;AAC5B,mBAAmB,EAAE,KAAK,CAAC;AAC3B,kBAAkB,CAAC;AACnB;AACA,MAAM,GAAG,IAAI;AACb,QAAQ,CAAC;AACT,KAAK,CAAC;AACN,IAAI,GAAG,IAAI,aAAa;AACxB,IAAI,OAAO,IAAI,QAAQ,CAAC,GAAG,CAAC,IAAI,EAAE,EAAE;AACpC,MAAM,OAAO,EAAE;AACf,QAAQ,cAAc,EAAE,iBAAiB;AACzC,QAAQ,eAAe,EAAE;AACzB;AACA,KAAK,CAAC;AACN,GAAG,CAAC,OAAO,KAAK,EAAE;AAClB,IAAI,IAAI,OAAO,CAAC,GAAG,CAAC,QAAQ,KAAK,YAAY,EAAE;AAC/C,MAAM,OAAO,CAAC,KAAK,CAAC,CAAC,+BAA+B,EAAE,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC;AACtE;AACA,IAAI,OAAO,IAAI,QAAQ,CAAC,0BAA0B,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE,CAAC;AACpE;AACA;;;;"}